<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Busway</title>
  <link rel="stylesheet" href="css/busway.css" />
  <link rel="stylesheet" href="css/calculadora.css" />
  <link rel="stylesheet" href="css/header.css" />
  <link rel="stylesheet" href="components/RODAPE_CONWAY/css/style.css" />
  <link rel="icon" href="images/icon.png">

  <script src="https://kit.fontawesome.com/89d28f01ec.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <!--Começo do header-->
  <div class="header">
    <div class="container">
      <ul>
        <li><a href="index.html">PÁGINA INICIAL</a></li>
        <li><a href="">LOGIN</a></li>
        <li>
          <a href=""><img src="images/menu.svg" alt="" /></a>
        </li>
      </ul>
    </div>
  </div>
  <!--Fim do header-->

  <div class="bus-img">
    <img src="images/onibus.svg" alt="" />
    <p class="titulo-banner">Busway</p>
  </div>
  <div class="banner">
    <div class="container">
      <div class="bannertext">
        <p class="problema">
          Em metrópoles, um problema muito recorrente é a
          <b>superlotação dos transportes públicos</b>, afinal estespossuem
          poucos métodos de se distribuir corretamente, além de que os dados
          coletados pelos motoristas são muito rasos e demorados de se
          identificar e corrigir. Certas rotas possuem diversos problemas,
          como superlotação em certos locais e veículos completamente vazios
          em outras.
          <b>Causando diversos atrasos para os clientes, além de perda de
            dinheiro para a companhia que controla esses ônibus.
          </b>
        </p>
        <div class="empresa">
          <p>
            O BusWay auxiliá a empresa interessada a administrar melhor suas
            linhas, visando reduzir as perdas para quase 0.
          </p>
          <div class="rota-img">
            <img src="images/rota.svg" alt="rota" />
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="banner">
    <div class="container">
      <div class="como-funciona">
        <p class="titulo-banner">Como funciona?</p>
        <p class="texto-banner">
          Serão instalados três sensores no veículo, são esses:
        </p>
        <ul class="sensores">
          <li>
            <b>Sensor 1:</b> Estará localizado na porta de entrada e ele
            verificará se as portas forem abertas;
          </li>
          <li>
            <b>Sensor 2:</b> Também estará localizado na porta de entrada mas
            este contabilizará as entradas;
          </li>
          <li>
            <b>Sensor 3:</b>Estará localizado na porta de saída contabilizando
            o número total de passageiros que deixaram o transporte.
          </li>
        </ul>
      </div>
      <div class="circle-img"></div>
    </div>
  </div>
  <div id="calculadora">
    <h1>Simulador de custos</h1>
    <div class="field">
      <p>Número Total de Passageiros:</p>
      <div class="iconInput">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 512">
          <path
            d="M406.5 399.6C387.4 352.9 341.5 320 288 320H224c-53.5 0-99.4 32.9-118.5 79.6C69.9 362.2 48 311.7 48 256C48 141.1 141.1 48 256 48s208 93.1 208 208c0 55.7-21.9 106.2-57.5 143.6zm-40.1 32.7C334.4 452.4 296.6 464 256 464s-78.4-11.6-110.5-31.7c7.3-36.7 39.7-64.3 78.5-64.3h64c38.8 0 71.2 27.6 78.5 64.3zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-272a40 40 0 1 1 0-80 40 40 0 1 1 0 80zm-88-40a88 88 0 1 0 176 0 88 88 0 1 0 -176 0z" />
        </svg>
        <input type="number" id="passageiros">
      </div>
    </div>
    <div class="field">
      <p>Distância Total Percorrida (em quilometros):</p>
      <div class="iconInput">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 512">
          <path
            d="M565.6 36.2C572.1 40.7 576 48.1 576 56V392c0 10-6.2 18.9-15.5 22.4l-168 64c-5.2 2-10.9 2.1-16.1 .3L192.5 417.5l-160 61c-7.4 2.8-15.7 1.8-22.2-2.7S0 463.9 0 456V120c0-10 6.1-18.9 15.5-22.4l168-64c5.2-2 10.9-2.1 16.1-.3L383.5 94.5l160-61c7.4-2.8 15.7-1.8 22.2 2.7zM48 136.5V421.2l120-45.7V90.8L48 136.5zM360 422.7V137.3l-144-48V374.7l144 48zm48-1.5l120-45.7V90.8L408 136.5V421.2z" />
        </svg>
        <input type="number" id="distancia">
      </div>
    </div>
    <div class="field">
      <p>Tempo de Viagem (em horas):</p>
      <div class="iconInput">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 512">
          <path
            d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" />
        </svg>
        <input type="number" id="tempo">
      </div>
    </div>
    <div class="field">
      <p>Custo total da Viagem:</p>
      <div class="iconInput">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 512">
          <path
            d="M112 112c0 35.3-28.7 64-64 64V336c35.3 0 64 28.7 64 64H464c0-35.3 28.7-64 64-64V176c-35.3 0-64-28.7-64-64H112zM0 128C0 92.7 28.7 64 64 64H512c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128zM176 256a112 112 0 1 1 224 0 112 112 0 1 1 -224 0zm80-48c0 8.8 7.2 16 16 16v64h-8c-8.8 0-16 7.2-16 16s7.2 16 16 16h24 24c8.8 0 16-7.2 16-16s-7.2-16-16-16h-8V208c0-8.8-7.2-16-16-16H272c-8.8 0-16 7.2-16 16z" />
        </svg>
        <input type="number" id="custo">
      </div>
    </div>
    <div class="field buttons">
      <button type="button" onclick="calcularEficiencia()">Calcular</button>
      <button type="button" onclick="calcularEficiencia()">Saiba mais</button>
    </div>

    <p>A eficiência do transporte é: <span id="resultado"></span></p>
    <p>O rank de eficiência é: <span id="rank"></span></p>
    <p><span id="dados"></span></p>
    <div id="div_msg"></div>
    <div id="graficos">
      <canvas id="graficoAvaliacao"></canvas>
  </div>
  </div>
</body>

</html>
<script>
  function calcularEficiencia() {
    // Obter os dados de entrada do usuário
    var passageiros = Number(document.getElementById("passageiros").value);
    var distancia = Number(document.getElementById("distancia").value);
    var tempo = Number(document.getElementById("tempo").value);
    var custo = Number(document.getElementById("custo").value);

    // Calcular a eficiência com base nos dados fornecidos
    var eficiencia = (passageiros * distancia) / (tempo * custo) * 100;

    // Definir o rank de eficiência com base no resultado obtido
    var rank;
    var cor;
    if (eficiencia >= 90) {
      rank = "Excelente";
      cor = "#0792e3";
    } else if (eficiencia >= 70) {
      rank = "Bom";
      cor = "#75dc0d";
    } else if (eficiencia >= 50) {
      rank = "Regular";
      cor = "#F9f006";
    } else {
      rank = "Ruim";
      cor = "#F90d29";
    }

    // Exibir o resultado para o usuário
    document.getElementById("resultado").innerHTML = eficiencia.toFixed(2) + "%";
    document.getElementById("rank").innerHTML = rank;

    // Calcular o prejuízo da empresa caso não adote o projeto
    var custoTotal = passageiros * 5; // custo médio por passageiro
    var lucroTotal = passageiros * 2.5; // lucro médio por passageiro
    var custoManutencao = 500; // custo médio de manutenção do veículo por mês
    var precoCombustivel = 3.5; // preço médio do combustível por litro
    var consumoCombustivel = 10; // consumo médio de combustível do veículo (em km/L)

    var distanciaMensal = passageiros * distancia * 30; // distância percorrida mensalmente considerando 30 dias úteis
    var litrosCombustivel = distanciaMensal / consumoCombustivel;
    var custoCombustivel = litrosCombustivel * precoCombustivel;
    var custoTotalMensal = custoTotal + custoManutencao + custoCombustivel;
    var lucroTotalMensal = lucroTotal * passageiros * 30; // lucro mensal considerando 30 dias úteis

    document.getElementById("dados").innerHTML = `Seu lucro total mensal é: R$${lucroTotalMensal}<br><br>
      Seus gastos mensais considerando manutenção e combustível: R$${custoTotalMensal}<br><br>`;

    var money;
    if (custoTotalMensal > lucroTotalMensal || rank == "Ruim") {
      document.getElementById("dados").innerHTML += `A linha está com desempenho ruim, entre em contato com a Conway para entregarmos dados que podem ajudar a melhorar a eficiência dessa linha.`
    }
    else {
      if (rank == "Regular") {
        document.getElementById("dados").innerHTML += `A linha não está eficiênte, ela pode melhorar usando nosso sistema.`
      }
      else {
        if (rank == "Bom") {
          document.getElementById("dados").innerHTML += `A linha está eficiênte, mas pode melhorar usando nosso sistema.`
        }
        else {
          if (rank == "Excelente") {
            document.getElementById("dados").innerHTML += `A linha está em sua eficiencia máxima, se você deseja manter esse padrão e se preparar para crises contate a Conway.`
          }

        }
      }
    }
    div_msg.innerHTML = `Considerando o cenário atual, a empresa tem uma eficiência média de transporte de ${eficiencia.toFixed(2)}%. Se a empresa adotar o
      projeto, é garantido um aumento inicial para ${(eficiencia + 20).toFixed(2)}%. Com base nisso, podemos fazer a seguinte
      análise de viabilidade:`
    gerarGrafico(eficiencia, rank, cor);
  }
  function gerarGrafico(eficiencia, rank, cor) {
    var possivel = 100; 
    if(eficiencia>=100){
      possivel = 0;
      cor = "#0792e3";
    }
    const avaliacao = {
      labels: ["Otimização Atual","Otimização possível"],
      datasets: [{
        label: "A",
        backgroundColor: [cor,"white"],
        data: [Number(eficiencia),possivel],
        hoverOffset:4
      }
      ]
    }
    const configAvaliacao = {
      type: "doughnut",
      data: avaliacao
    }
    const graficoAvaliacao = new Chart(
        document.getElementById("graficoAvaliacao"),
        configAvaliacao
    );
  }
</script>